---
apiVersion: v1
kind: Secret
metadata:
  name: "{{ app.name }}-secret"
  namespace: "{{ app.namespace | default('default') }}"
  labels:
    app: "{{ app.name }}"
type: Opaque
data:
  # Encode all secret values as Base64
  DB_USER: "{{ db_user | b64encode }}"
  DB_PASSWORD: "{{ db_password | b64encode }}"
  BUSINESS_DB_USER: "{{ business_db_user | b64encode }}"
  BUSINESS_DB_PASSWORD: "{{ business_db_password | b64encode }}"
  LOYALTY_DB_USER: "{{ loyalty_db_user | b64encode }}"
  LOYALTY_DB_PASSWORD: "{{ loyalty_db_password | b64encode }}"
  DB_PASS: "{{ db_pass | b64encode }}"
  STG_DB_PASSWORD: "{{ stg_db_password | b64encode }}"
  amazonProperties.accessKey: "{{ aws_access_key | b64encode }}"
  amazonProperties.secretKey: "{{ aws_secret_key | b64encode }}"
  AWS_ACCESS_KEY: "{{ aws_access_key | b64encode }}"
  AWS_SECRET_KEY: "{{ aws_secret_key | b64encode }}"
  amazonProperties.assetsSecretKey: "{{ aws_secret_key | b64encode }}"
  amazonProperties.assetsAccessKey: "{{ aws_access_key | b64encode }}"
  JWT_SECRET: "{{ jwt_secret | b64encode }}"
  REDIS_PASSWORD: "{{ redis_password | b64encode }}"
  CONFIG_USER: "{{ config_user | b64encode }}"
  CONFIG_PASS: "{{ config_pass | b64encode }}"
  SPRING_MAIL_USERNAME: "{{ mail_username | b64encode }}"
  SPRING_MAIL_PASSWORD: "{{ mail_password | b64encode }}"
  SPRING_MAIL_FROM: "{{ mail_from | b64encode }}"
  ENCRYPTION_SECRET_KEY: "{{ encryption_secret_key | b64encode }}"

  # Add any service-specific secrets, also base64 encoded
  {% if app.secrets is defined %}
  {% for item in app.secrets %}
  "{{ item.name }}": "{{ item.value | b64encode }}"
  {% endfor %}
  {% endif %}
